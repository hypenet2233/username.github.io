<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HYPE NET — Admin Ultimate</title>
  
  <link rel="icon" href="https://i.postimg.cc/fLSj38WK/hype-net512.jpg" type="image/jpeg">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
    body{font-family:'Tajawal',sans-serif;background:#f3f4f6;}
    /* شاشة القفل */
    #login-overlay {position: fixed; inset: 0; background: #111827; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;}
    .section-title { border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; margin-bottom: 20px; color: #374151; font-weight: bold; font-size: 1.25rem; }
  </style>

  <script>
    window.__app_id = "hype-net-display-page";
    window.__firebase_config = JSON.stringify({"apiKey": "AIzaSyBaDcnOmMeZaoJT6wLRlezFsveJL7aAtdc", "authDomain": "hype-net-display-page.firebaseapp.com", "projectId": "hype-net-display-page", "storageBucket": "hype-net-display-page.firebasestorage.app", "messagingSenderId": "505174394261", "appId": "1:505174394261:web:92fe3ffec55c8a2ad0a29c", "measurementId": "G-M7YWJKGP62"});
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, onSnapshot, doc, deleteDoc, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const config = JSON.parse(__firebase_config);
    const app = initializeApp(config);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const appId = "hype-net-display-page";

    // ==========================================
    //       نظام الحماية (كلمة المرور)
    // ==========================================
    const SECRET_PIN = "saeed14233"; 

    window.checkLogin = function() {
      const input = document.getElementById('admin-password').value;
      if (input === SECRET_PIN) {
        document.getElementById('login-overlay').style.display = 'none';
        signIn(); 
      } else {
        alert("كلمة المرور خاطئة!");
      }
    }

    async function signIn() {
       await signInAnonymously(auth);
       loadLinks();
       loadProducts();
       loadPortfolio();
    }

    // --- 1. إدارة الروابط (النظام القديم) ---
    async function addLink(){
      const title = document.getElementById('link-title').value.trim();
      const url = document.getElementById('link-url').value.trim();
      if(!title || !url) return alert('البيانات ناقصة');
      await addDoc(collection(db, `artifacts/${appId}/public/data/links`), { title, url, timestamp: serverTimestamp() });
      document.getElementById('link-title').value=''; document.getElementById('link-url').value='';
    }

    function loadLinks(){
        onSnapshot(query(collection(db, `artifacts/${appId}/public/data/links`), orderBy('timestamp','desc')), (snap)=>{
            const box = document.getElementById('links-container'); box.innerHTML='';
            snap.forEach(d => createItemElement(d, box, 'links'));
        });
    }

    // --- 2. إدارة المنتجات (النظام القديم) ---
    async function addProduct(){
      const title = document.getElementById('product-title').value.trim();
      const url = document.getElementById('product-url').value.trim();
      if(!title || !url) return alert('البيانات ناقصة');
      await addDoc(collection(db, `artifacts/${appId}/public/data/products`), { title, url, timestamp: serverTimestamp() });
      document.getElementById('product-title').value=''; document.getElementById('product-url').value='';
    }

    function loadProducts(){
        onSnapshot(query(collection(db, `artifacts/${appId}/public/data/products`), orderBy('timestamp','desc')), (snap)=>{
            const box = document.getElementById('products-container'); box.innerHTML='';
            snap.forEach(d => createItemElement(d, box, 'products'));
        });
    }

    // --- 3. إدارة المعرض (النظام الجديد المضاف) ---
    async function addPortfolio(){
      const title = document.getElementById('port-title').value.trim();
      const url = document.getElementById('port-url').value.trim();
      const img = document.getElementById('port-img').value.trim();
      const platform = document.getElementById('port-platform').value;

      if(!title || !url || !img) return alert('البيانات ناقصة (تأكد من الصورة)');
      await addDoc(collection(db, `artifacts/${appId}/public/data/portfolio`), { title, url, img, platform, timestamp: serverTimestamp() });
      document.getElementById('port-title').value=''; document.getElementById('port-url').value=''; document.getElementById('port-img').value='';
    }

    function loadPortfolio(){
        onSnapshot(query(collection(db, `artifacts/${appId}/public/data/portfolio`), orderBy('timestamp','desc')), (snap)=>{
            const box = document.getElementById('portfolio-container'); box.innerHTML='';
            snap.forEach(d => {
                const item = d.data();
                const el = document.createElement('div');
                el.className = 'bg-white p-3 rounded shadow flex items-center gap-3 border border-gray-200';
                el.innerHTML = `
                    <img src="${item.img}" class="w-12 h-12 object-cover rounded">
                    <div class="flex-1">
                        <div class="font-bold text-sm">${item.title}</div>
                        <div class="text-xs text-blue-600">${item.platform}</div>
                    </div>
                    <button class="text-red-500 text-sm font-bold" onclick="deleteItem('portfolio', '${d.id}')">X</button>
                `;
                box.appendChild(el);
            });
        });
    }

    // دالة مساعدة
    function createItemElement(docData, container, collectionName) {
        const item = docData.data();
        const el = document.createElement('div');
        el.className = 'bg-gray-50 p-2 rounded flex justify-between items-center mb-2 border';
        el.innerHTML = `<span>${item.title}</span> <button class="text-red-500 font-bold" onclick="deleteItem('${collectionName}', '${docData.id}')">X</button>`;
        container.appendChild(el);
    }

    window.addLink = addLink;
    window.addProduct = addProduct;
    window.addPortfolio = addPortfolio;
    window.deleteItem = async (col, id) => { if(confirm('حذف؟')) await deleteDoc(doc(db, `artifacts/${appId}/public/data/${col}`, id)); };
  </script>
</head>
<body class="bg-gray-100 pb-20">

  <!-- شاشة القفل -->
  <div id="login-overlay">
    <div class="text-center">
      <h2 class="text-2xl font-bold mb-4">Admin Access</h2>
      <input type="password" id="admin-password" placeholder="Enter PIN" class="p-2 rounded text-black text-center mb-2 block w-full">
      <button onclick="checkLogin()" class="bg-green-600 px-6 py-2 rounded font-bold w-full">Unlock</button>
    </div>
  </div>

  <div class="max-w-4xl mx-auto p-4">
    <h1 class="text-3xl font-black text-gray-800 mb-8 text-center mt-4">لوحة التحكم الشاملة</h1>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        
        <!-- القسم 1: الروابط العامة -->
        <div class="bg-white p-6 rounded-xl shadow-md">
            <h2 class="section-title">1. الروابط العامة (Links)</h2>
            <div class="space-y-3 mb-4">
                <input id="link-title" placeholder="عنوان الرابط" class="w-full p-2 border rounded">
                <input id="link-url" placeholder="الرابط URL" class="w-full p-2 border rounded">
                <button onclick="addLink()" class="w-full bg-gray-700 text-white p-2 rounded">أضف رابط</button>
            </div>
            <div id="links-container" class="text-sm"></div>
        </div>

        <!-- القسم 2: المنتجات النصية -->
        <div class="bg-white p-6 rounded-xl shadow-md">
            <h2 class="section-title">2. المنتجات (Products)</h2>
            <div class="space-y-3 mb-4">
                <input id="product-title" placeholder="اسم المنتج" class="w-full p-2 border rounded">
                <input id="product-url" placeholder="رابط المنتج" class="w-full p-2 border rounded">
                <button onclick="addProduct()" class="w-full bg-gray-700 text-white p-2 rounded">أضف منتج</button>
            </div>
            <div id="products-container" class="text-sm"></div>
        </div>

    </div>

    <!-- القسم 3: معرض التصاميم (الجديد) -->
    <div class="bg-white p-6 rounded-xl shadow-md mt-6 border-2 border-green-500">
        <h2 class="section-title text-green-700">3. معرض التصاميم والصور (Portfolio) ✨ جديد</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <input id="port-title" placeholder="اسم التصميم" class="p-2 border rounded">
            <select id="port-platform" class="p-2 border rounded bg-gray-50">
                <option value="redbubble">Redbubble</option>
                <option value="amazon">Amazon</option>
                <option value="behance">Behance</option>
                <option value="other">أخرى</option>
            </select>
            <input id="port-url" placeholder="رابط الشراء" class="p-2 border rounded">
            <input id="port-img" placeholder="رابط الصورة (Image Address)" class="p-2 border rounded">
        </div>
        <button onclick="addPortfolio()" class="w-full bg-green-600 hover:bg-green-700 text-white p-3 rounded font-bold shadow">نشر التصميم في المعرض</button>
        
        <div id="portfolio-container" class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-6"></div>
    </div>

  </div>
</body>
</html>